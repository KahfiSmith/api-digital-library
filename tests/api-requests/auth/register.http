@baseUrl = {{$dotenv API_BASE_URL}}

### Register new user (change username/email for unique registration)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "username": "testuser123",
  "email": "test123@example.com",
  "password": "Password123!",
  "firstName": "Test",
  "lastName": "User"
}

### Get current user using cookie (no header needed)
GET {{baseUrl}}/auth/me

### Refresh token (uses cookie by default)
POST {{baseUrl}}/auth/refresh

> {% 
// Rotate tokens (update globals)
try {
  if (response.status === 200) {
    const body = JSON.parse(response.body);
    const tokens = body?.data?.tokens || body?.tokens;
    if (tokens && tokens.accessToken && tokens.refreshToken) {
      client.global.set("accessToken", tokens.accessToken);
      client.global.set("refreshToken", tokens.refreshToken);
      client.log("Rotated tokens and updated globals");
    } else {
      client.log("Tokens not found in refresh response body");
    }
  }
} catch (e) {
  client.log("Failed to parse JSON response: " + e.message);
}
%}

### Logout (uses refresh cookie; no body needed)
POST {{baseUrl}}/auth/logout
